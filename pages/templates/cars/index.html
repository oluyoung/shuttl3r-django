{% extends 'pages/base.html' %}
{% load staticfiles  %}
{% block stylesheet %}
<link rel="stylesheet" href="{% static 'css/cars-styles.css' %}">
{% endblock %}
{% block content %}
<section class="container cars-container" style="background:url()">
  <p class="order-alert full-width" style=""></p>
  <nav class="filters"></nav>
  <section class="wrap cars-wrap" style="background:url({% static 'img/bgnoise_lg_@2X.png' %})" >
  {% for car in cars %}
    {% if car.available_for_use %}
      <div class="license car-license car-{{car.id}}">
        <div class="pos-rel flex col-wrap just-center align-flex-center" >
          <img src="{% static 'img/tack-red.png' %}" style="height:30px;position:absolute;left:42%;top:0"/>
          <!-- Image holder -->
          <div class="image full-width flex align-flex-center">
            <img src="{{car.image_url}}" alt="{{car.get_full_name}}" class="full-width" >
          </div>
          <p class="title text-center capitalize">{{car.make}} {{car.name}}</p>
          <div class="flex row-nowrap just-between align-flex-center">
            <p class="type"><span class="key">AVAIL.</span> {% if car.isAvailable %}Y
            {%else%}X</p><p class="type"><span class="key">FREE</span> {{car.nextAvailability}}{% endif %}
            </p>  
          </div>
          <a href="#car-{{car.id}}" class="btn view-btn poppins block">VIEW</a>
        </div>

        <!-- ORDER SHEET -->
        <section class="container sheet car-sheet mfp-hide" id="car-{{car.id}}">
          <div class="content car flex row-wrap just-start" >
            <div class="top-info flex row-nowrap">
              <div class="car-license">
                <img class="image" src="{{car.image_url}}" alt="{{car.make}} {{car.name}}">
              </div>
              <div class="car-info">
                <table>
                  <tr>
                    <th class="key small-caps">Name </th>
                    <td class="capitalize">{{car.make}} {{car.name}}</td>
                  </tr>
                  <tr>
                    <th class="key small-caps">Avail. </th>
                    <td class="capitalize">{% if car.isAvailable %}Y{%else%}X{% endif %}</td>
                  </tr>
                  <tr>
                    {% if car.isAvailable %}{%else%}
                    <th class="key small-caps">Free </th>
                    <td>{{car.nextAvailability}}</td>
                    {% endif %}
                  </tr>
                </table>
              </div>
            </div>
            <!-- Order Form -->
            <div class="order-form car-order-form material-form">
              <div class="text-center">
                <h3>To make a request just fill the form below</h3>
              </div>
              <form action="/hire/cars/request/car/" class="form flex col-wrap" method="post">
                {% csrf_token %}
                <input type="hidden" class="item_id" name="item_id" value="{{car.id}}">
                <input type="hidden" class="user_id" name="user_id" value="{{user.id}}">
                <div class="flex row-wrap just-between">
                  <div class="flex row-wrap just-start align-flex-center half-width">
                    <label for="within">Leaving Lagos?</label>
                    <input type="checkbox" class="within" name="within_lagos" hidden>
                    <a href="#" class="choose-btn yes">YES</a><a href="#" class="choose-btn no selected">NO</a>
                  </div>
                </div>
                <div class="flex row-wrap just-between">
                  <div class="half-width">
                    <label for="start-date">Start Date</label>
                    {% if car.isAvailable %}
                    <input type="date" class="order-date start-date" name="start_date" min="{% now 'Y-m-d' %}" required>
                    {%else%}
                    <input type="date" class="order-date start-date" name="start_date" min="{{car.nextAvailability|date:'Y-m-d'}}" required>
                    {% endif %}
                  </div>
                  <div class="half-width">
                    <label for="end-date">End Date</label>
                    {% if car.isAvailable %}
                    <input type="date" class="order-date end-date" name="end_date" min="{% now 'Y-m-d' %}" required>
                    {%else%}
                    <input type="date" class="order-date end-date" name="start_date" min="{{car.nextAvailability|date:'Y-m-d'}}" required>
                    {% endif %}
                  </div>
                </div>

                <div class="flex col-nowrap">
                  <label for="pickup-addr" class="">Pickup Address</label>
                  <input type="text" class="pickup-addr" name="pickup_addr" placeholder="Pickup Address" value="{{user.default_pickup_addr}}" required>
                </div>

                {% if user.is_authenticated %}
                <input type="submit" class="btn submit-btn" id="cars-submit-btn" value="REQUEST" />
                <input type="reset" value=clear hidden />
                {% else %}
                <a href="#login" class="btn login-btn">LOGIN</a>
                {% endif %}
              </form>
            </div>
          </div>
        </section>
      </div>
      
    {% endif%}
  {% endfor %}
  </section>
{% endblock %}